// SPDX-License-Identifier: GPL-2.0
/*
 * Copyright (c) 2014 SUSE LINUX Products GmbH
 *
 * Derived from zynq-zed.dts:
 *
 *  Copyright (C) 2011 Xilinx
 *  Copyright (C) 2012 National Instruments Corp.
 *  Copyright (C) 2013 Xilinx
 */
/dts-v1/;
#include "zynq-7000.dtsi"
#include <dt-bindings/gpio/gpio.h>

/ {
	model = "Adapteva Parallella board";
	compatible = "adapteva,parallella", "xlnx,zynq-7000";

	aliases {
		ethernet0 = &gem0;
		serial0 = &uart1;
		spi0 = &qspi;
	};

	memory@0 {
		device_type = "memory";
		reg = <0x0 0x40000000>;
	};

	chosen {
		bootargs = "root=/dev/mmcblk0p2 rootfstype=ext4 rw rootwait";
		stdout-path = "serial0:115200n8";
	};

	leds {
		compatible = "gpio-leds";

		cr10 {
			label = "parallella:cr10:usr";
			gpios = <&gpio0 7 GPIO_ACTIVE_HIGH>;
			default-state = "on";
		};
	};
};

&clkc {
	fclk-enable = <0xf>;
	ps-clk-frequency = <33333333>;
};

&gem0 {
	status = "okay";
	phy-mode = "rgmii-id";
	phy-handle = <&ethernet_phy>;

	ethernet_phy: ethernet-phy@0 {
		/* Marvell 88E1318 */
		compatible = "ethernet-phy-id0141.0e90",
		             "ethernet-phy-ieee802.3-c22";
		reg = <0>;
		device_type = "ethernet-phy";
		marvell,reg-init = <0x3 0x10 0xff00 0x1e>,
		                   <0x3 0x11 0xfff0 0xa>;
	};
};

&i2c0 {
	status = "okay";

	isl9305: isl9305@68 {
		compatible = "isil,isl9305", "isl,isl9305";
		reg = <0x68>;

		regulators {
			regulator_epiphany: dcd1 {
				regulator-name = "VDD_DSP";
				regulator-min-microvolt =  <900000>;
				regulator-max-microvolt = <1200000>;
			};
			regulator_vdd_1_35: dcd2 {
				regulator-name = "1P35V";
				regulator-always-on;
			};
			regulator_vdd_adj: ldo1 {
				regulator-name = "VDD_ADJ";
				regulator-always-on;
			};
			regulator_vdd_gpio: ldo2 {
				regulator-name = "VDD_GPIO";
				regulator-always-on;
			};
		};
	};
};

&qspi {
	u-boot,dm-pre-reloc;
	status = "okay";

	flash@0 {
		compatible = "micron,n25q128a13";
		reg = <0x0>;
		spi-max-frequency = <50000000>;
		#address-cells = <1>;
		#size-cells = <1>;
		m25p,fast-read;
		partition@0 {
			label = "boot";
			reg = <0x00000000 0x004e0000>;
		};
		partition@4e0000 {
			label = "bootenv";
			reg = <0x004e0000 0x00020000>;
		};
		partition@ff0000 {
			label = "version";
			reg = <0x00ff0000 0x00010000>;
			/* Offset	Name	Description
			 * 0x0:		Version	32-bit LSB running number @0x0
			 * 0x4		Magic	"0x13371338"
			 */
		};
	};
};

&sdhci1 {
	u-boot,dm-pre-reloc;
	status = "okay";
};

&uart1 {
	u-boot,dm-pre-reloc;
	status = "okay";
};
